---
title: "vinculacion_tablas"
output: html_document
date: "2025-10-27"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
datos_calidad<-read.csv("data/rvvcca.csv",sep=";",header=TRUE)

#    Leemos solo 1 línea (nrows=1) y saltamos las 3 líneas de metadatos.
nombres <- read.csv("data/2023/MDEST462500472023_AVFRANCIA.csv", 
                        sep = "\t", dec = ",", 
                        header = FALSE, 
                        skip = 3, 
                        nrows = 1)

#Leer los DATOS, saltando las 4 líneas de encabezados + unidades
#Saltamos las 3 líneas de metadatos + la línea de nombres (4) + la línea de unidades (5).
datos_2023 <- read.csv("data/2023/MDEST462500472023_AVFRANCIA.csv", 
                       sep = "\t", dec = ",", 
                       header = FALSE,
                       skip = 5) 

names(datos_2023) <- nombres
print("NOMBRES 2023")
print(names(datos_2023))
print("NOMBRES DATOS CALIDAD")
print(names(datos_calidad))


library(dplyr)

# A. Estandarizar NOMBRES 2023 (Datos Meteorológicos)
# Asumimos que estos nombres ya están asignados a datos_2023
# Solo vamos a renombrar las variables de meteo a nombres más claros:
datos_2023 <- datos_2023 %>%
  rename(
    Fecha=FECHA,
    Velocidad.del.viento = Veloc.,  # Veloc. se convierte a Velocidad.del.viento
    Direccion.del.viento = Direc.,  # Direc. se convierte a Direccion.del.viento
  )


datos_combinados <- bind_rows(datos_calidad, datos_2023)

# 2. Crear la nueva columna 'Id' secuencial
datos_combinados <- datos_combinados %>%
  # Creamos una nueva columna 'Id' que asigna un número de fila secuencial
  # a todo el conjunto de datos combinado.
  mutate(Id = row_number(),Estacion = "Avda. Francia") %>%
  # Opcional: Reordenar las columnas para que 'Id' sea la primera
  select(Id, everything())

# Verificación
# 1. Mira las últimas filas (deberían ser las de 2023)
head(datos_combinados) 
tail(datos_combinados)

```

